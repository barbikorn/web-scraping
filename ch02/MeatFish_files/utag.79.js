//tealium universal tag - utag.79 ut4.0.201901101231, Copyright 2019 Tealium.com Inc. All Rights Reserved.
window.GoogleAnalyticsObject=""||"ga";window[window.GoogleAnalyticsObject]=window[window.GoogleAnalyticsObject]||function(){(window[window.GoogleAnalyticsObject].q=window[window.GoogleAnalyticsObject].q||[]).push(arguments);};try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){b.hFlag=0;b.onreadystatechange=function(){if((this.readyState==='complete'||this.readyState==='loaded')&&!b.hFlag){b.hFlag=1;o.cb();}};b.onload=function(){if(!b.hFlag){b.hFlag=1;o.cb();}};}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={'view':1,'link':1};u.o=window[window.GoogleAnalyticsObject];u.required={};u.created=false;u.all=function(e,o,v,a,b,c){for(var i=0;i<u.data.account.length;i++){var t=(u.data.name[i]?u.data.name[i]+".":"");if(o==="event"){u.o(t+e,o,v,a,b,c)}else if(v){u.o(t+e,o,v)}else{u.o(t+e,o);}}};u.setHitData=function(g,a,b,f){var obj=u.data[a];for(var d in utag.loader.GV(obj)){if(b&&d.indexOf("enh_"+b+"-")!==0&&d.indexOf("enh_all-")!==0){continue;}
var idx=d.split("-")[1],val=obj[d];if(u.typeOf(val)!=="array"){g[idx]=val;}else{g[idx]=val[f];}}};u.addEvent=function(v){if(typeof v.eventCategory=="undefined"||typeof v.eventAction=="undefined"){utag.DB("GA event Category or Action is not set");return;}
if(isNaN(parseInt(v.eventValue))){utag.DB("GA event Value is not a number");v.eventValue=null;}else{v.eventValue=parseInt(v.eventValue)||null;}
u.data.ga_events.push(v);};u.addproduct=function(event_type,len,imp){var g={},i,j,k=[];if(imp===true&&utag.data.page_name!="groceries:checkout:order confirmation"&&utag.data.page_template!="productDetails"){k=(u.data.enh_impression_id.length?u.data.enh_impression_id:u.data.enh_impression_name);for(i=0;i<k.length;i++){g={};g.id=(u.data.enh_impression_id[i]?u.data.enh_impression_id[i]:"");g.name=(u.data.enh_impression_name[i]?u.data.enh_impression_name[i]:"");g.brand=(u.data.enh_impression_brand[i]?u.data.enh_impression_brand[i]:"");g.variant=(u.data.enh_impression_variant[i]?u.data.enh_impression_variant[i]:"");g.category=(u.data.enh_impression_category[i]?u.data.enh_impression_category[i]:"");g.list=(u.data.enh_impression_list[i]?u.data.enh_impression_list[i]:"");g.price=(u.data.enh_impression_price[i]?u.data.enh_impression_price[i]:"");g.position=(u.data.enh_impression_position[i]?u.data.enh_impression_position[i]:"");u.setHitData(g,"enhecom_events",event_type,i);u.all('ec:addImpression',g);}
}else if(utag.data.page_name=="groceries:checkout:order confirmation"){for(i=0;i<len;i++){g={};if(u.data.autofill_params==="true"){for(j=0;j<u.data.product_id.length;j++){u.data.product_name[j]=u.data.product_name[j]||u.data.product_id[j];u.data.product_unit_price[j]=u.data.product_unit_price[j]||"1.00";u.data.product_quantity[j]=u.data.product_quantity[j]||"1";}}
g.id=u.data.product_id[i];g.price=(u.data.product_unit_price[i]?u.data.product_unit_price[i]:"");g.quantity=(u.data.product_quantity[i]?u.data.product_quantity[i]:"");u.setHitData(g,"enhecom_events",event_type,i);u.all('ec:addProduct',g);}}else{for(i=0;i<len;i++){g={};if(u.data.autofill_params==="true"){for(j=0;j<u.data.product_id.length;j++){u.data.product_name[j]=u.data.product_name[j]||u.data.product_id[j];u.data.product_unit_price[j]=u.data.product_unit_price[j]||"1.00";u.data.product_quantity[j]=u.data.product_quantity[j]||"1";}}
g.id=u.data.product_id[i];g.name=(u.data.product_name[i]?u.data.product_name[i]:"");g.brand=(u.data.product_brand[i]?u.data.product_brand[i]:"");g.variant=(u.data.product_variant[i]?u.data.product_variant[i]:"");g.category=(u.data.product_category[i]?u.data.product_category[i]:"");g.price=(u.data.product_unit_price[i]?u.data.product_unit_price[i]:"");g.quantity=(u.data.product_quantity[i]?u.data.product_quantity[i]:"");g.coupon=(u.data.product_discount[i]?u.data.product_discount[i]:"");g.position=(u.data.product_position[i]?u.data.product_position[i]:"");u.setHitData(g,"enhecom_events",event_type,i);u.all('ec:addProduct',g);}}};u.addpromo=function(action,event){var f,g;for(f=0;f<u.data.enh_promo_id.length;f++){g={};g.id=u.data.enh_promo_id[f];g.name=(u.data.enh_promo_name[f]?u.data.enh_promo_name[f]:u.data.enh_promo_id[f]);g.creative=(u.data.enh_promo_creative[f]?u.data.enh_promo_creative[f]:"");g.position=(u.data.enh_promo_position[f]?u.data.enh_promo_position[f]:"");u.all('ec:addPromo',g);}
if(action==="promo_click"&&event==="link"){u.all('ec:setAction',u.data.enh_action);if(u.data.autosend_events==="true"){u.all('send','event','EEC','Promotion click',(g.name?g.name:g.id),{'hitCallback':u.data.enh_event_cb});}}};u.createTracker=function(){var i,tn,start;if(u.typeOf(u.data.account)==="string"){u.data.account=u.data.account.replace(/\s/g,"").split(",");}
if(u.typeOf(u.data.name)==="string"&&u.data.name!==""){u.data.name=u.data.name.replace(/\s/g,"").split(",");}
if(!u.data.name||u.data.name.length!==u.data.account.length){start=u.data.name.length!==u.data.account.length?u.data.name.length:0;tn=utag.tagsettings.gua.trackernames;u.data.name=u.data.name||[];for(i=start;i<u.data.account.length;i++){u.data.name.push("tealium_"+(i+tn));}
utag.tagsettings.gua.trackernames=tn+i;}};u.initTracker=function(){var c,f;if(!u.created){u.created=true;for(f=0;f<u.data.account.length;f++){c={};if(u.data.siteSpeedSampleRate){c.siteSpeedSampleRate=parseInt(u.data.siteSpeedSampleRate);}
if(u.data.sampleRate){c.sampleRate=parseFloat(u.data.sampleRate);}
c.cookieDomain=u.data.cookieDomain;if(u.data.cookieExpires||u.data.cookieExpires==="0"){c.cookieExpires=parseInt(u.data.cookieExpires);}
if(u.data.legacyCookieDomain){c.legacyCookieDomain=u.data.legacyCookieDomain;}
if(u.data.legacyHistoryImport==="false"||u.data.legacyHistoryImport===false){c.legacyHistoryImport=u.data.legacyHistoryImport;}
c.allowLinker=u.data.allowLinker;if(typeof u.data.name[f]!=="undefined"&&u.data.name[f]!==""){c.name=u.data.name[f];}
if(u.data.clientId){c.clientId=u.data.clientId;}
u.o("create",u.data.account[f],c);}
if(u.data.global_event_cb){u.all('set','hitCallback',u.data.global_event_cb);}
if(u.data.optimizely==="true"){window.optimizely=window.optimizely||[];window.optimizely.push(['activateUniversalAnalytics']);}}};u.setGlobalProperties=function(data,reset,custom_property){var map={"uid":{"name":"&uid","type":"exists","reset":true},"page":{"name":"page","type":"exists","reset":true},"title":{"name":"title","type":"exists","reset":true},"location":{"name":"location","type":"exists","reset":false},"campaignId":{"name":"campaignId","type":"exists","reset":true},"campaignName":{"name":"campaignName","type":"exists","reset":true},"campaignSource":{"name":"campaignSource","type":"exists","reset":true},"campaignMedium":{"name":"campaignMedium","type":"exists","reset":true},"campaignContent":{"name":"campaignContent","type":"exists","reset":true},"campaignKeyword":{"name":"campaignKeyword","type":"exists","reset":true},"dataSource":{"name":"dataSource","type":"exists","reset":true}},prop;if(custom_property&&reset){u.all("set",custom_property,"");}
for(prop in utag.loader.GV(map)){if(reset&&map[prop].reset){u.all("set",map[prop].name,"");}else{if(map[prop].type==="bool"){if(data[prop]==true||data[prop]==="true"){u.all("set",map[prop].name,true);}}
else if(map[prop].type==="exists"){if(data[prop]){u.all("set",map[prop].name,data[prop]);}}}}};window.utag.tagsettings=window.utag.tagsettings||{};window.utag.tagsettings.gua=window.utag.tagsettings.gua||{};window.utag.tagsettings.gua.trackernames=window.utag.tagsettings.gua.trackernames||0;u.map={"ga_tracking_id":"tid","rendering_reference":"dimension2","user_status":"dimension8","page_name":"product_action_list,dimension24","page_template":"dimension3,pageview-contentGroup1","page_section":"dimension4","page_category":"dimension5,pageview-contentGroup2","page_subcategory":"dimension6,pageview-contentGroup3","page_subsubcategory":"dimension7,pageview-contentGroup4","ga_enh_action":"enh_action","ga_enh_action:detail":"detail","ga_enh_action:purchase":"purchase","ga_enh_action:refund":"refund","review_number":"enh_detail-dimension10,enh_product_add-dimension10","review_score":"enh_detail-dimension9,enh_product_add-dimension9","_cprod":"product_id,enh_impression_id","_cprodname":"product_name,enh_impression_name","product_position_array":"enh_impression_position","first_order_ref":"transaction-dimension1","checkout_step":"enh_checkout_step","atb_price_array":"product_unit_price","atb_quantity_array":"product_quantity","shopping_mode":"enh_product_add-dimension12","atb_quantity_type":"enh_product_add-dimension11","atb_matrix_position_number":"product_position","trolley_item_number":"enh_product_add-dimension14","ga_event_category":"eventCategory","ga_event_action":"eventAction","ga_event_label":"eventLabel","order_shipping_method":"dimension15","booking_slot_cost":"dimension16","websphere_id":"uid,dimension17","non_interaction":"nonInteraction","page_name_array":"enh_impression_list","product_finding_method":"enh_product_add-dimension13","search_results":"dimension18","ga_product_id_hit":"dimension20","search_term":"dimension22","search_term_original":"dimension21","search_category":"dimension23","test_user":"dimension25","page_event:order confirmation":"purchase","page_event:cancellation":"refund","ga_order_size":"transaction-dimension27","ga_affiliation":"affiliation","ga_clean_url":"page","event_name:espotclick":"promo_click","ga_promo_creative":"enh_promo_creative","ga_promo_id":"enh_promo_id","ga_promo_name":"enh_promo_name","order_delivery_storeid":"dimension26","ga_dedupped_orders_metric":"transaction-metric1","parent_sku":"enh_product_add-dimension28","site_version":"dimension29","ga_voucher_id":"coupon","ga_events_array":"ga_events","delivery_option":"dimension40","order_delivery_slot":"dimension41","order_delivery_day":"dimension42","order_lead_time":"dimension44","order_delivery_slottime":"dimension45","ga_delivery_location_hashed":"dimension43","delivery_greenslots":"dimension46","delivery_status":"dimension47","delivery_price":"dimension48","delivery_type":"dimension15","order_id":"order_id","order_cancelled":"order_id","ga_order_cancelled":"metric2","ga_order_amend_metric":"metric3","zoom_product":"dimension49","ga_cancelled_order_revenue":"revenue","amended_order_id":"order_id","ga_order_carrier_bags":"transaction-metric6","fm_allergens":"link-dimension65","ga_page_location":"location","site_platform":"dimension30","ga_eSpotNamesFinal":"enh_promo_name","ga_eSpotIdsFinal":"enh_promo_id","ga_eSpotCreativeFinal":"enh_promo_creative","ga_eSpotRelPositionFinal":"enh_promo_position","ga_voucher_discount":"transaction-metric4","ga_trolley_savings":"transaction-metric5","cp._ga":"dimension66","user_agent":"dimension68","survey_id":"dimension69","survey_title":"dimension70","survey_answers":"dimension71","ut.profile":"dimension72","ut.version":"dimension73","ut.env":"dimension74","ga_pfm_category":"enh_product_add-dimension75","user_id":"dimension76","sh_click_url":"dimension77","sh_link_position":"dimension78","sh_category_name":"dimension79","product_action_list":"product_action_list","fm_profile_status":"link-dimension80","fm_toogle_value_pageview":"pageview-dimension81","fm_toggle_value":"link-dimension67,link-dimension81","login_page_entry_point":"dimension82","is_uk_billing":"dimension84","new_page_template":"dimension85","search_filters":"link-dimension89,enh_product_add-dimension99,dimension89","search_filters_change":"link-dimension90,enh_product_add-dimension98","identity_id":"dimension87","ga_filter_selection":"link-metric13","ga_filter_removal":"link-metric14","ga_sessionid":"dimension93","Frenzy_Budget":"link-dimension94","Frenzy_color":"link-dimension95","Frenzy_pairing":"link-dimension96","Frenzy_occasion":"link-dimension97","datalayer_version":"dimension100"};u.extend=[function(a,b){try{if((b['event_name'].toString().toLowerCase()=='addToBasket'.toLowerCase()&&typeof b['event_name']!='undefined'&&b['event_name']!='')||(b['event_name'].toString().toLowerCase()=='firstAddToBasket'.toLowerCase()&&typeof b['event_name']!='undefined'&&b['event_name']!='')){if(typeof digitalData.product=="object"){var i;var id;var productName=[];var pid=b.product_id;var products=digitalData.product;for(i=0;i<products.length;i++){id=products[i].productInfo.productId;if(id==pid){productName.push(products[i].productInfo.productName);}}
b.product_name=productName;if(b._cprodname.length==0){b._cprodname=b.product_name;}}
else{console.log("No digitalData.product");}
var price_array=[];var quantity_array=[];var newEvent=[];var eventInfo;if(typeof digitalData.event[digitalData.event.length-1]=="object"){newEvent=digitalData.event[digitalData.event.length-1];eventInfo=newEvent.eventInfo;}
else if(typeof digitalData.page.events[0]=='object'){eventInfo=digitalData.page.events[0];}
else{eventInfo="";}
if(eventInfo!=""){if(utag.data&&utag.data.page_name!=undefined){b.product_action_list=utag.data.page_name;}
b.ga_product_id_hit=b.product_id[0];var unitPrice;var itemMaxWeight;if(eventInfo.quantityType=="weight"||eventInfo.quantityType=="weight range"){if(eventInfo.weight!==""){quantity_array.push(Math.ceil(eventInfo.weight));price_array.push(Number(eventInfo.itemPrice));}
else{quantity_array.push(eventInfo.quantity);try{itemMaxWeight=Number(eventInfo.weightRange.replace(/^[^-]+-|k?g/g,""));if(/[^k]g+$/.test(eventInfo.weightRange)){itemMaxWeight=itemMaxWeight/1000;}}catch(e){}
price_array.push((Number(eventInfo.itemPrice)*itemMaxWeight).toFixed(2));}}
else{quantity_array.push(eventInfo.quantity);price_array.push(eventInfo.itemPrice);}
b.atb_quantity_array=quantity_array;b.atb_price_array=price_array;try{b.trolley_item_number=document.getElementById("trolleyTableBody").rows.length;}catch(e){}
var searchPos=window.getSearchPosition(eventInfo.productSKU);var positionNumber=[];if(utag.data.search_term){if(searchPos){positionNumber.push(searchPos);b.atb_matrix_position_number=positionNumber;}}
else if(searchPos){positionNumber.push(searchPos);b.atb_matrix_position_number=positionNumber;}}
else{console.log("No ATB eventInfo");}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){b['non_interaction']='false'}}catch(e){utag.DB(e)}},function(a,b){try{if(1){if(utag.data['dom.query_string']===""){b['ga_clean_url']=b['dom.pathname'];}
else{b['ga_clean_url']=b['dom.pathname']+"?"+b['dom.query_string'].replace(/=([^&]+@[^\.]+)\./g,'=xxx@xxx.');}}}catch(e){utag.DB(e)}},function(a,b){try{if(b['page_template']=='productDetails'){try{b['review_number']=digitalData.product[0].productAttributes.reviewsNumber;}catch(e){};try{b['review_score']=digitalData.product[0].productAttributes.reviewScore;}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){try{if((b['page_template'].toString().toLowerCase()=='productDetails'.toLowerCase()&&b['ut.event'].toString().toLowerCase()=='view'.toLowerCase())){if(b["ga_pdp_binary"]!="true"){var interval=setInterval(function(){if(typeof digitalData.product=='object'&&digitalData.product.length>0){setProductName();}},1000)}
function setProductName(){var productName=[];productName.push(digitalData.product[0].productInfo.productName);b.product_name=productName;if(utag.data.ga_pdp_event!="true"){b.ga_enh_action="detail";b.ga_event_category='EEC';b.ga_event_action='Product details view';b.non_interaction=true;utag.link(b,null,[79]);clearInterval(interval);b["ga_pdp_binary"]="true";utag.data.ga_pdp_event="true";}}}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){d=b['page_name'];if(typeof d=='undefined')return;c=[{'groceries:delivery:delivery booking':'1'},{'groceries:collect:collection slot booking':'1'},{'groceries:fulltrolley':'2'},{'groceries:checkout:product upsell':'3'},{'groceries:checkout:forgotten your favourites':'4'}];var m=false;for(e=0;e<c.length;e++){for(f in c[e]){if(d==f){b['checkout_step']=c[e][f];m=true};};if(m)break};},function(a,b,c,d,e,f,g){d=b['page_event'];if(typeof d=='undefined')return;c=[{'order review':'5'}];var m=false;for(e=0;e<c.length;e++){for(f in c[e]){if(d==f){b['checkout_step']=c[e][f];m=true};};if(m)break};},function(a,b){try{if((b['page_template'].toString().toLowerCase()=='shelf'.toLowerCase()&&b['ut.event']=='view')||(b['page_template'].toString().toLowerCase()=='search'.toLowerCase()&&b['ut.event']=='view')||(b['page_template'].toString().toLowerCase()=='great prices'.toLowerCase()&&b['ut.event']=='view')){var pids=[];var pnames=[];var positions=[];var pageNames=[];if(b.ga_prod_list_fired!==true){var interval=setInterval(function(){if(typeof digitalData.product=='object'&&digitalData.product.length>0){setProductArrays();}},1000);}
function setProductArrays(){var items=digitalData.product;var i,j;var page=b.page_name;try{for(i=0;i<items.length;i++){pids.push(items[i].productInfo.productId);pnames.push(items[i].productInfo.productName);pageNames.push(page);j=i+1;positions.push(j);}
b.product_id=pids;b.product_name=pnames;b.product_position_array=positions;b.page_name_array=pageNames;clearInterval(interval);b.ga_prod_list_fired=true;}catch(err){b.ga_prod_list_fired=true;}}}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){d=b['page_name'];if(typeof d=='undefined')return;c=[{'groceries:delivery:delivery booking':'checkout'},{'groceries:collect:collection slot booking':'checkout'},{'groceries:fulltrolley':'checkout'},{'groceries:checkout:product upsell':'checkout'},{'groceries:checkout:forgotten your favourites':'checkout'},{'groceries:checkout:order review':'checkout'}];var m=false;for(e=0;e<c.length;e++){for(f in c[e]){if(d==f){b['ga_enh_action']=c[e][f];m=true};};if(m)break};},function(a,b,c,d,e,f,g){d=b['event_name'];if(typeof d=='undefined')return;c=[{'addToBasket':'add'},{'firstAddToBasket':'add'}];var m=false;for(e=0;e<c.length;e++){for(f in c[e]){if(d==f){b['ga_enh_action']=c[e][f];m=true};};if(m)break};},function(a,b){try{if(b['dom.domain'].toString().toLowerCase().indexOf('recipes.sainsburys.co.uk'.toLowerCase())>-1){tealium.jQuery(document).mousedown(function(e){if(typeof b.ga_event_fired==='undefined'&&b['ut.event']=='view'){var promo_name;var promo_id;var promo_creative;var promo_type;var target=e.target;if(target.tagName=="A"||target.tagName=="IMG"||target.tagName=="SPAN"){var atag1=target.closest('a[class^="mini-promo"]');var atag2=target.closest('a[class^="rhs__promo"]');var atag3=target.closest('a[class^="mission"]');var atag4=target.closest('div[class^="mini-promo"]').getElementsByClassName("mini-promo__image")[0];if(atag1||atag2||atag3||atag4){var atag;if(atag1){atag=atag1;}
else if(atag2){atag=atag2;}
else if(atag3){atag=atag3;}
else{atag=atag4;}
promo_name=tealium.jQuery(atag).attr("href").match(/INTCMP=(.*)/)[1];b.promo_name=promo_name;var divContainer;if(atag1||atag4){divContainer=target.closest('div.mini-promo__item');}
else if(atag2){divContainer=target.closest('a.rhs__promo');}
else{divContainer=target.closest('a.mission');}
var creativeTarget;var substring;if(atag1||atag4||atag2){creativeTarget=tealium.jQuery(divContainer).find('img:eq(0)').attr("src");substring=creativeTarget.split('/').slice(3);promo_creative='/'+substring.join('/');}
else{creativeTarget=tealium.jQuery(divContainer).attr("style");substring=creativeTarget.split('/').slice(3);promo_creative='/'+substring.join('/');promo_creative=promo_creative.substring(0,promo_creative.length-1);}
b.promo_creative=promo_creative;if(atag1||atag4){promo_type='mini-promo';}
else if(atag2){promo_type='rhs-promo';}
else if(atag3){promo_type='mission-promo';}
else{promo_type='other-promo';}
var imageName=creativeTarget.split('/').slice(-1)[0].substr(0,creativeTarget.split('/').slice(-1)[0].lastIndexOf('.'));promo_id=promo_type+'>'+imageName;b.espot_reference=promo_id;document.cookie="espot_click="+promo_id+";path=/;domain="+utag.cfg.domain+";expires=";b.ga_event_fired=true;if(utag.data.ga_promo_click!="true"){b.ga_eSpotNamesFinal=[];b.ga_eSpotIdsFinal=[];b.ga_eSpotCreativeFinal=[];b.ga_eSpotRelPositionFinal=[];b.ga_eSpotNamesFinal.push(promo_name);b.ga_eSpotIdsFinal.push(promo_id);b.ga_eSpotCreativeFinal.push(promo_creative);b.event_name='espotclick';utag.data.ga_promo_click="true";utag.link(b,null,[79]);}}}}})}}catch(e){utag.DB(e)}},function(a,b){try{if(b['event_name'].toString().toLowerCase()=='espotclick'.toLowerCase()){var creative=[];var name=[];var id=[];creative.push(b.promo_creative);id.push(b.espot_reference);name.push(b.promo_name);b.ga_promo_creative=creative;b.ga_promo_id=id;b.ga_promo_name=name;}}catch(e){utag.DB(e)}},function(a,b){try{if(b['event_name'].toString().toLowerCase()=='espotclick'.toLowerCase()){b['ga_event_category']='eSpot';b['ga_event_action']='Click';b['ga_event_label']=b['espot_reference']}}catch(e){utag.DB(e)}},function(a,b){try{if((b['espot_event']=='1'&&typeof b['espot_reference']!='undefined'&&b['cp.espot_click'].toString().toLowerCase()!='false'.toLowerCase())){b['ga_event_category']='eSpot';b['ga_event_action']='Next page load';b['ga_event_label']=b['espot_reference']}}catch(e){utag.DB(e)}},function(a,b){try{if(b['page_template'].toString().toLowerCase()=='search'.toLowerCase()){if(typeof b.page_secondary_event=='string'&&b.page_secondary_event=='didyoumean'){b.search_category='Did you mean';}
else if(b.search_results==0){b.search_category='No results';}
else{b.search_category='Successful search';}}}catch(e){utag.DB(e)}},function(a,b){try{if((b['page_template'].toString().toLowerCase()=='shelf'.toLowerCase()&&b['ut.event'].toString().toLowerCase()=='view'.toLowerCase())||(b['page_template'].toString().toLowerCase()=='search'.toLowerCase()&&b['ut.event'].toString().toLowerCase()=='view'.toLowerCase())||(b['page_template'].toString().toLowerCase()=='great prices'.toLowerCase()&&b['ut.event'].toString().toLowerCase()=='view'.toLowerCase())){if(b.ga_extension!="true"){var intervalBis=setInterval(function(){if(typeof digitalData.product=='object'&&digitalData.product.length>0&&b.product_id.length>0){breakUpProdImpression();}},1000)}
var config={"arrays_to_split":["product_id","product_name","product_position_array","page_name_array"],"primary_variable":"product_id","max_array_length":20},gua_tag_ids=[],handled_flag=false,temp_b_object={},array_length=0,num_of_arrays=0,i,current_array_index_min=0,current_array_index_max=0;function findGUA(){var ids=[],prop;for(prop in utag.sender){if(utag.sender[prop].setHitData&&utag.sender[prop].addpromo){ids.push(prop);}}
return(ids.length>0?ids:null);}
function remove_impression_data(arrays_to_remove,b){var i,temp_b_impressions_removed=utag.loader.GV(b);for(i=0;i<arrays_to_remove.length;i++){try{delete temp_b_impressions_removed[arrays_to_remove[i]];}catch(e){temp_b_impressions_removed[arrays_to_remove[i]]=undefined;}}
return temp_b_impressions_removed;}
function get_b_obj(min,max,product_arrays,b){var i=0,temp_b_object=utag.loader.GV(b);for(i=0;i<product_arrays.length;i++){if(b[product_arrays[i]]&&b[product_arrays[i]].length>0){temp_b_object[product_arrays[i]]=b[product_arrays[i]].slice(min,max);}}
temp_b_object.ga_event_category="EEC";temp_b_object.ga_event_action="Product impressions";temp_b_object.non_interaction="true";temp_b_object.ga_extension="true";return temp_b_object;}
gua_tag_ids=findGUA();function breakUpProdImpression(){if(gua_tag_ids!==null){if(config.arrays_to_split.length>0&&b[config.primary_variable].length>0){handled_flag=true;array_length=b[config.primary_variable].length;num_of_arrays=Math.floor(array_length/config.max_array_length);if((array_length%config.max_array_length)!==0){num_of_arrays=num_of_arrays+1;}
for(i=0;i<num_of_arrays;i++){if(i===0){current_array_index_min=0;}else{current_array_index_min=current_array_index_max;}
current_array_index_max=current_array_index_max+config.max_array_length;temp_b_object=get_b_obj(current_array_index_min,current_array_index_max,config.arrays_to_split,b);if(typeof temp_b_object.ga_events_array!='undefined'){delete temp_b_object.ga_events_array;}
utag.link(temp_b_object,null,gua_tag_ids);}}}
clearInterval(intervalBis);}
if(handled_flag===true){utag.view(remove_impression_data(config.arrays_to_split,b),null,gua_tag_ids);return false;}}}catch(e){utag.DB(e)}},function(a,b){try{if((/checkout/.test(b['page_template'])&&b['ut.event'].toString().toLowerCase()=='view'.toLowerCase()&&b['page_name'].toString().toLowerCase()=='groceries:checkout:order confirmation'.toLowerCase())){b['ga_clean_url']='order confirmation page'
b['ga_page_location']=b["dom.domain"]+"/order_confirmation_page"}}catch(e){utag.DB(e)}},function(a,b){try{if((/checkout/.test(b['page_template'])&&b['ut.event'].toString().toLowerCase()=='view'.toLowerCase()&&b['page_name'].toString().toLowerCase()=='groceries:checkout:order confirmation'.toLowerCase())){if(b.ga_extension!=="true"){b.ga_voucher_discount=0;b.ga_trolley_savings=0;var totalAddedQuantity=0;var totalRemovedQuantity=0;if(b.amended_order_id&&b.product_id.length>0){var addedQty=b.product_amend_increment_quantity;for(var i=0;i<b.product_id.length;i++){if(addedQty[i]==""){totalAddedQuantity=Number(totalAddedQuantity)+0;}
else{totalAddedQuantity=Number(totalAddedQuantity)+Number(addedQty[i]);}}
if(totalAddedQuantity>0){b.ga_order_amend_purchase="true";}
var removedQty=b.product_amend_decrement_quantity;for(var i=0;i<b.product_id.length;i++){if(removedQty[i]==""){totalRemovedQuantity=Number(totalRemovedQuantity)+0;}
else{totalRemovedQuantity=Number(totalRemovedQuantity)+Number(removedQty[i]);}}
if(totalRemovedQuantity>0){b.ga_order_amend_refund="true";}}
if(b.ga_order_amend_refund=="true"){orderAmendRemove();}
if(b.product_id.length==0){b._cship=0;b._cpdisc=0;b._ctotal=0;b.order_total=0;b.ga_affiliation="chunk_n";b.ga_order_amend_metric=1;try{b.delivery_option=digitalData.user.profile.profileInfo.deliveryOption;}
catch(e){}}
if(typeof b.amended_order_id!="string"||b.ga_order_amend_purchase=="true"){var interval=setInterval(function(){if(typeof digitalData.transaction.item=='object'&&digitalData.transaction.item.length>0&&b.product_id.length>0){populateProdPriceQty();breakUpTransaction();}},1000)}
else{true}}
function populateProdPriceQty(){var i,j;var product_price_array=[];var product_quantity_array=[];var quantity,itemMaxWeight,price;var tempPrice3;if(!digitalData.transaction.amendOrderId){var itemCount=digitalData.transaction.item.length;b.ga_order_size=itemCount;var itemInst;for(i=0;i<itemCount;i++){itemInst=digitalData.transaction.item[i];if(itemInst.productInfo.weightRange!==""){quantity=itemInst.quantity;price=(Number(itemInst.price)/Number(quantity)).toFixed(2);product_quantity_array.push(quantity);product_price_array.push(price);}
else if(itemInst.productInfo.quantityType=="weight"){product_quantity_array.push(Math.ceil(Number(itemInst.productInfo.weight)));tempPrice3=(Number(itemInst.price)/Number(itemInst.productInfo.weight)).toFixed(2);product_price_array.push(tempPrice3);}
else{product_quantity_array.push(itemInst.quantity);product_price_array.push(itemInst.altPrice);}}
b.product_quantity=product_quantity_array;b.product_price=product_price_array;}
else if(digitalData.transaction.amendOrderId){orderAmendAdd();var temp_quantity=b.product_quantity;var temp_price=b.product_price;var itemInst;var itemCount=digitalData.transaction.item.length;b.ga_order_size=itemCount;for(i=0;i<b.product_id.length;i++){product_quantity_array.push(temp_quantity[i]);for(j=0;j<itemCount;j++){itemInst=digitalData.transaction.item[j];if(b.product_id[i]==itemInst.productInfo.productId){if(itemInst.productInfo.weightRange!==""){price=(Number(itemInst.price)/Number(itemInst.quantity)).toFixed(2);product_price_array.push(price);}
else if(itemInst.productInfo.quantityType=="weight"){price=(Number(temp_price[i])/temp_quantity[i]).toFixed(2);product_price_array.push(price);}
else{product_price_array.push(itemInst.altPrice);}}}}
b.product_quantity=product_quantity_array;b.product_price=product_price_array};}
var config={"arrays_to_split":["product_id","product_price","product_quantity"],"primary_variable":"product_id","max_array_length":175},gua_tag_ids=[],handled_flag=false,temp_b_object={},array_length=0,num_of_arrays=0,i,current_array_index_min=0,current_array_index_max=0;function findGUA(){var ids=[],prop;for(prop in utag.sender){if(utag.sender[prop].setHitData&&utag.sender[prop].addpromo){ids.push(prop);}}
return(ids.length>0?ids:null);}
function get_b_obj(min,max,product_arrays,b){var i=0,temp_b_object=utag.loader.GV(b);for(i=0;i<product_arrays.length;i++){if(b[product_arrays[i]]&&b[product_arrays[i]].length>0){temp_b_object[product_arrays[i]]=b[product_arrays[i]].slice(min,max);}}
temp_b_object.ga_extension="true";b.ga_extension="true";return temp_b_object;}
gua_tag_ids=findGUA();function breakUpTransaction(){if(gua_tag_ids!==null){if(config.arrays_to_split.length>0&&b[config.primary_variable].length>0){array_length=b[config.primary_variable].length;num_of_arrays=Math.floor(array_length/config.max_array_length);if((array_length%config.max_array_length)!==0){num_of_arrays=num_of_arrays+1;}
var cum_order_revenue=0;for(i=0;i<num_of_arrays;i++){if(i===0){current_array_index_min=0;}else{current_array_index_min=current_array_index_max;}
current_array_index_max=current_array_index_max+config.max_array_length;temp_b_object=get_b_obj(current_array_index_min,current_array_index_max,config.arrays_to_split,b);temp_b_object.ga_dedupped_orders_metric=0;temp_b_object.ga_affiliation='chunk_'+i;if(temp_b_object.ga_affiliation==='chunk_0'&&typeof temp_b_object.amended_order_id!='string'){temp_b_object.ga_dedupped_orders_metric=1;}
else{temp_b_object.ga_dedupped_orders_metric=0;}
if(temp_b_object.ga_affiliation==='chunk_0'&&typeof temp_b_object.amended_order_id=='string'&&b.ga_order_amend_refund!="true"){temp_b_object.ga_order_amend_metric=1;}
else{temp_b_object.ga_order_amend_metric=0;}
if(typeof temp_b_object.voucher_code=='object'){temp_b_object.ga_voucher_id=temp_b_object.voucher_code.join('|');}
var voucherTotal=0;var voucherDiscount=digitalData.transaction.total.voucherDiscount;for(var m=0;m<voucherDiscount.length;m++){voucherTotal=voucherTotal+Number(voucherDiscount[m]);}
if(voucherTotal>0){voucherTotal;}
else{voucherTotal=0;}
temp_b_object.ga_voucher_discount=voucherTotal.toFixed(2);if(typeof temp_b_object.amended_order_id!='string'){var remainder=Number(temp_b_object.order_total)+Number(temp_b_object.ga_voucher_discount)-Number(temp_b_object.order_shipping_cost)-Number(temp_b_object.order_base_revenue);if(Number(remainder).toFixed(2)==0.40){temp_b_object.ga_order_carrier_bags=0.40;}
else{temp_b_object.ga_order_carrier_bags=0;}}
if(num_of_arrays==1&&typeof temp_b_object.amended_order_id!='string'){chunk_order_revenue=temp_b_object.order_total-Number(temp_b_object.order_shipping_cost);chunk_order_revenue=Number(Number(chunk_order_revenue)-Number(temp_b_object.ga_order_carrier_bags)).toFixed(2);}
else{var prod_length=temp_b_object.product_id.length;var chunk_order_revenue=0;for(j=0;j<prod_length;j++){chunk_order_revenue=chunk_order_revenue+Number(temp_b_object.product_price[j])*Number(temp_b_object.product_quantity[j]);}}
if(typeof temp_b_object.trolley_savings!='undefined'){temp_b_object.ga_trolley_savings=temp_b_object.trolley_savings;}
if(num_of_arrays>1){if(i!==(num_of_arrays-1)){temp_b_object.order_shipping_cost=0;temp_b_object._cship=0;temp_b_object.ga_trolley_savings=0;temp_b_object.ga_voucher_discount=0;temp_b_object.ga_order_carrier_bags=0;temp_b_object.non_interaction="true";}}
if(typeof temp_b_object.amended_order_id=='string'){temp_b_object.order_shipping_cost=0;temp_b_object._cship=0;temp_b_object.ga_trolley_savings=0;temp_b_object.ga_voucher_discount=0;temp_b_object.non_interaction="true";}
if(num_of_arrays>1){chunk_order_revenue=Number(chunk_order_revenue);chunk_order_revenue=Number(chunk_order_revenue).toFixed(2);}
else{chunk_order_revenue=Number(chunk_order_revenue)+Number(temp_b_object.ga_voucher_discount);chunk_order_revenue=Number(chunk_order_revenue).toFixed(2);}
temp_b_object.order_total=chunk_order_revenue;temp_b_object.delivery_option=digitalData.user.profile.profileInfo.deliveryOption;utag.view(temp_b_object,null,gua_tag_ids);}}
clearInterval(interval);}}
function orderAmendAdd(){var prodId=[];var qtyValue=0;var priceValue=0;var addedQuantity=[];var addedPrice=[];var totalAdded=0;var totalAddedPrice=0;var addedProdId=[];var addedProdQty=[];var addedProdName=[];var addedProdPrice=[];b.order_id=b.amended_order_id;addedQuantity=b.product_amend_increment_quantity;addedPrice=b.product_amend_increment_value;if(b.ga_order_amend_refund=="true"){prodId=b.ga_temp_product_id;b.ga_order_amend_metric=0;b.ga_order_amend_refund_value=0;b.ga_enh_action="";}
else{prodId=b.product_id;}
for(var i=0;i<prodId.length;i++){if(addedQuantity[i]==""){qtyValue=0;}
else{qtyValue=parseInt(addedQuantity[i]);}
totalAdded=totalAdded+qtyValue;if(addedPrice[i]==""){priceValue=0;}
else{priceValue=parseFloat(addedPrice[i]);}
totalAddedPrice=totalAddedPrice+priceValue;}
if(totalAdded>0){for(var j=0;j<prodId.length;j++){if(addedQuantity[j]!=""){var tempProdPrice=0;addedProdId.push(prodId[j]);addedProdQty.push(parseInt(addedQuantity[j]));tempProdPrice=Number(addedPrice[j])/Number(addedQuantity[j]);addedProdPrice.push(Number(tempProdPrice).toFixed(2));for(var k=0;k<digitalData.transaction.item.length;k++){if(digitalData.transaction.item[k].productInfo.productId==prodId[j]){addedProdName.push(digitalData.transaction.item[k].productInfo.productName);}}}}
b.product_id=addedProdId;b.product_name=addedProdName;b.product_quantity=addedProdQty;b.product_price=addedProdPrice;}}
function orderAmendRemove(){var prodId=[];var price=0;var quantity=0;var removedQuantity=[];var removedPrice=[];var totalRemoved=0;var totalRemovedValue=0;var removedProdId=[];var removedProdQty=[];var removedProdPrice=[];var removedProdQty2=[];var removedProdPrice2=[];b.order_id=b.amended_order_id;removedQuantity=b.product_amend_decrement_quantity;removedPrice=b.product_amend_decrement_value;prodId=b.product_id;b.ga_temp_product_id=b.product_id;b.ga_enh_action="refund";for(var j=0;j<prodId.length;j++){if(removedQuantity[j]!=""){removedProdId.push(prodId[j]);removedProdQty.push(parseInt(removedQuantity[j]));removedProdPrice.push(Number(removedPrice[j]).toFixed(2));}}
for(var i=0;i<removedProdId.length;i++){removedProdQty2.push(removedProdQty[i]);tempPrice2=Number(Number(removedProdPrice[i])/Number(removedProdQty[i])).toFixed(2);removedProdPrice2.push(tempPrice2);}
b.product_id=removedProdId;b.product_quantity=removedProdQty2;b.product_price=removedProdPrice2;b._cprod=removedProdId;b._cquan=removedProdQty2;b._cprice=removedProdPrice2;b._cpdisc=0;b.ga_order_amend_metric=1;}}}catch(e){utag.DB(e)}},function(a,b){try{if((b['meganav_event']=='navigationEntry'&&typeof b['navigation_level']!='undefined'&&typeof b['navigation_taxonomy']!='undefined'&&b['ut.event']=='view')){if(b.ga_extension!='true'){b.ga_events_array=[{eventCategory:"Navigation entry",eventAction:b.navigation_level,eventLabel:b.navigation_taxonomy,nonInteraction:"true"}]
b.non_interaction="true";}else{b.ga_events_array=[]}}}catch(e){utag.DB(e)}},function(a,b){try{if((typeof b['cp.test_cookie']!='undefined'&&b['cp.test_cookie'].toString().indexOf('false')<0)){b['test_user']=b['cp.test_cookie']}}catch(e){utag.DB(e)}},function(a,b){try{if(b['page_event']=='error'||b['page_secondary_event']=='error'||b['event_name']=='wrongVoucher'||b['page_section']=='error'||b['page_template']=='error'||typeof b['error_message']!='undefined'){if(b.ga_extension!='true'){b.ga_events_array=[{eventCategory:"Error",eventAction:"Error",eventLabel:b.error_message}]}else{b.ga_events_array=[]}}}catch(e){utag.DB(e)}},function(a,b){try{if(b['page_name_identifier'].toString().toLowerCase()=='delivery booking'.toLowerCase()||b['page_name_identifier'].toString().toLowerCase()=='collection slot booking'.toLowerCase()||(typeof b['booking_event']!='undefined'&&b['booking_event'].toString().toLowerCase()=='delivery'.toLowerCase())||b['page_name'].toString().toLowerCase()=='groceries:checkout:order confirmation'.toLowerCase()){b['ga_delivery_location_hashed']=b['delivery_location']}}catch(e){utag.DB(e)}},function(a,b){try{if(typeof b['ga_delivery_location_hashed']!='undefined'){b.ga_delivery_location_hashed=btoa(b.ga_delivery_location_hashed)}}catch(e){utag.DB(e)}},function(a,b){try{if(b['page_event'].toString().toLowerCase()=='switch collection'.toLowerCase()||b['page_event'].toString().toLowerCase()=='switch delivery'.toLowerCase()){b['ga_event_category']='Delivery';b['ga_event_action']='Click to switch';b['ga_event_label']=b['page_category']}}catch(e){utag.DB(e)}},function(a,b){try{if(b['booking_event'].toString().toLowerCase()=='collect'.toLowerCase()){b['ga_event_category']='Delivery';b['ga_event_action']='Choose slot';b['ga_event_label']='Collection'}}catch(e){utag.DB(e)}},function(a,b){try{if(b['booking_event'].toString().toLowerCase()=='delivery'.toLowerCase()){b['ga_event_category']='Delivery';b['ga_event_action']='Choose slot';b['ga_event_label']='Home delivery'}}catch(e){utag.DB(e)}},function(a,b){try{if(b['page_name'].toString().toLowerCase()=='groceries:collect:collection slot booking'.toLowerCase()){b.ga_event_category="Delivery";b.ga_event_action="Select store location";b.ga_event_label="";if(b.rendering_reference=="mobileweb"){try{var storeName=$(".bookDeliveryAddress").find("p")[0].innerHTML.trim();b.ga_delivery_location_hashed=storeName;}
catch(err){b.ga_delivery_location_hashed="Store name unavailable";}}
else{try{var tag=$(".postcode")[0];var storeName;if(tealium.jQuery(tag).find("a").length==0){storeName=$(".postcode")[0].innerHTML.trim();}
else{storeName=$(".fulfilmentLocation")[0].innerHTML.trim();}
b.ga_delivery_location_hashed=storeName;}
catch(err){b.ga_delivery_location_hashed="Store name unavailable";}}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){if(typeof b.page_subcategory=='undefined'){b.page_subcategory="(not set)";}
else{b.page_subcategory;}
if(typeof b.page_category=='undefined'){b.page_category="(not set)";}
else{b.page_category;}
if(typeof b.page_subsubcategory=='undefined'){b.page_subsubcategory="(not set)";}
else{b.page_subsubcategory;}}}catch(e){utag.DB(e)}},function(a,b){try{if(b['page_event'].toString().indexOf('product_zoom')>-1){b.ga_events_array=[{eventCategory:"Click to zoom",eventAction:"Click to zoom",eventLabel:b.zoom_product,}]}}catch(e){utag.DB(e)}},function(a,b){try{if(b['page_event'].toString().toLowerCase()=='cancellation'.toLowerCase()){try{b['ga_cancelled_order_revenue']=digitalData.page.events[0].basePrice}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){window.currentLength=0;window.previousLength=0
window.lastObjIdMousedown=null;window.lastEventInfo=null;window.timeForWait=1000;window.numberTryCheckEventExists=0;var fmArrEventTracked=fmArrEventTracked||[];function checkEventExists(numTry){numberTryCheckEventExists++;var containsEvent=false;try{if(numTry!==undefined&&window.numberTryCheckEventExists<=4){setTimeout(function(){window.numberTryCheckEventExists++;containsEvent=(typeof(digitalData.event)!=="undefined"&&digitalData.event.length>0);if(containsEvent){trackingFoodMaestroEvent();}else{checkEventExists(window.numberTryCheckEventExists);}},1000);}}catch(err){console.warn("Tealium extension 184: Error.\n"+err);}}
function trackingFoodMaestroEvent(){try{var ga_event_category="Food Maestro";window.lastEventInfo=digitalData.event[digitalData.event.length-1].eventInfo;window.currentLength=digitalData.event.length;if(window.currentLength>window.previousLength){re=new RegExp('^(fMaestroProfileCreate|fmProfileCreated|fmCreateProfile|fmCreateProfilePopup1Abandoned|fmCreateProfilePopup2Abandoned|fmCreateProfilePopup3Abandoned|fmCreateProfileTermsAndConditions|fmToggleOn|fmToggleOff|fmRHWTermsAndConditions|fmProfileUpdate|fmCreateProfileUnavailable|fmRHWUnavailable|fmEditProfileUnavailable)$');if(re.exec(window.lastEventInfo.eventName)!==null){switch(lastEventInfo.eventName.toLocaleLowerCase()){case"fmprofilecreated":var fm_allergens=null;if("Allergens"in lastEventInfo){fm_allergens=lastEventInfo.Allergens.sort().toString();}
if(fm_allergens===""){fm_allergens="(not set)";}
utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Profile created","ga_event_label":fm_allergens,"fm_allergens":fm_allergens,"fm_profile_status":"Active"});try{tealium.jQuery("#fmCreateProfileTCPopup").on("mousedown",function(e){if(e.which==3){utag.link({"ga_event_category":"Food Maestro","ga_event_action":"Creating profile","ga_event_label":"Pop up 4 - Read terms and conditions"});}});}catch(err){console.warn("Tealium extension 184: Error.\n"+err);}
break;case"fmcreateprofile":utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Creating profile","ga_event_label":"Pop up 1 - open"});break;case"fmcreateprofilepopup1abandoned":utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Creating profile","ga_event_label":"Pop up 1 - abandoned"});break;case"fmcreateprofilepopup2abandoned":utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Creating profile","ga_event_label":"Pop up 2 - abandoned"});break;case"fmcreateprofilepopup3abandoned":utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Creating profile","ga_event_label":"Pop up 3 - abandoned"});break;case"fmcreateprofiletermsandconditions":utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Creating profile","ga_event_label":"Pop up 4 - Read terms and conditions"});break;case"fmprofileupdate":var fm_allergens=null;if("Allergens"in lastEventInfo){fm_allergens=lastEventInfo.Allergens.sort().toString();}
if(fm_allergens===""){fm_allergens="(not set)";}
utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Update profile","ga_event_label":fm_allergens,"fm_allergens":fm_allergens});fm_allergens=null;break;case"fmcreateprofileunavailable":utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Creating profile","ga_event_label":"Food Maestro Unavailable - Pop up 3"});break;case"fmrhwunavailable":var eLabel=lastEventInfo.eventName;if(eLabel=="fmRHWUnavailable"){eLabel="Food Maestro Unavailable";}
utag.link({"ga_event_category":ga_event_category,"ga_event_action":"RHW Unavailable","ga_event_label":eLabel});break;case"fmeditprofileunavailable":utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Update profile","ga_event_label":"Food Maestro Unavailable"});break;case"fmrhwunavailable":utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Creating profile","ga_event_label":"Food Maestro Unavailable – RHWU"});break;case"fmeditprofileunavailable":if(!isCloseButton){utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Update profile","ga_event_label":"Food Maestro Unavailable"});}
break;}
fmArrEventTracked.push(lastEventInfo.eventName.toLocaleLowerCase());}}else{re=new RegExp('^(fmCreateProfileUnavailable|fmRHWUnavailable|fmEditProfileUnavailable)$');if(re.exec(window.lastEventInfo.eventName)!==null){switch(lastEventInfo.eventName.toLocaleLowerCase()){case"fmeditprofileunavailable":if(!isCloseButton){utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Update profile","ga_event_label":"Food Maestro Unavailable"});}
break;case"fmrhwunavailable":utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Creating profile","ga_event_label":"Food Maestro Unavailable – RHWU"});break;case"fmeditprofileunavailable":utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Update profile","ga_event_label":"Food Maestro Unavailable"});break;}}else if((window.lastObjIdMousedown.toLocaleLowerCase()=="fmaestroprofilecreate")&&(!tealium.jQuery("#fMaestroErrorMessage").hasClass("hidden"))){utag.link({"ga_event_category":ga_event_category,"ga_event_action":"Creating profile","ga_event_label":"Food Maestro Unavailable – RHWU"});}}}catch(err){console.warn("Tealium extension 184: Error.\n"+err);}}
if(window.tealiumExtensionFMaestro==undefined){tealium.jQuery(document).on("mousedown",function(e){try{if(detectLeftButton(e)){window.lastObjIdMousedown=e.target.id;var isIdentifiedButton=false;var isEditProfileCLick=(e.target.id=="fMaestroProfileEdit");var isCloseButton=false;window.numberTryCheckEventExists=0;var re=new RegExp('^(fMaestroProfileCreate|fmProfileReviewContinueButton|fmCreateProfileTCPopup|fmProfileConditionsSaveButton|fMaestroProfileTC)$');isIdentifiedButton=(re.exec(e.target.id)!==null);window.previousLength=digitalData.event.length;if(!isIdentifiedButton&&!isEditProfileCLick){try{if(e.target.id.toLowerCase()=="fmprofileyesdeletebutton"){utag.link({"ga_event_category":"Food Maestro","ga_event_action":"Profile Deleted","ga_event_label":"","fm_profile_status":"Deleted"});}else{if(window.commonObject.cookies.getCookie("debugger_emc")=="184-1"){debugger}
try{isCloseButton=((e.target.parentElement.parentElement.id.toLowerCase()=="fm_overlaybox")&&(e.target.className.toLowerCase().indexOf("closelink")>-1));}catch(err){isCloseButton=false;}}}catch(err){console.log("Tealium extension 184: Error.\n"+err);}}
window.timeForWait=window.timeForWait||1000;checkEventExists(numberTryCheckEventExists);}else{try{if(e.target.id.toLowerCase()=="fmcreateprofiletcpopup"){utag.link({"ga_event_category":"Food Maestro","ga_event_action":"Creating profile","ga_event_label":"Pop up 4 - Read terms and conditions"});}}catch(err){console.warn("Tealium extension 184: Error.\n"+err);}}}catch(err){console.warn("Tealium extension 184: Error.\n"+err);}});window.tealiumExtensionFMaestro=true;tealium.jQuery("#fMaestroProfileTC").on("click",function(e){try{utag.link({"ga_event_category":"Food Maestro","ga_event_action":"Click to Terms and Conditions","ga_event_label":""});}catch(err){console.warn("Tealium extension 184: Error.\n"+err);}});}}}catch(e){utag.DB(e)}},function(a,b){try{if(b['page_name']=='sainsburys:homepage'){b['site_platform']='sainsburys:homepage'}}catch(e){utag.DB(e)}},function(a,b){try{if(b['ut.event'].toString().toLowerCase()=='view'.toLowerCase()){var x,w;var pos;var count;var substring;var eSpotType=[];var eSpots=[];var eSpotIds=[];var eSpotDivIds=[];var eSpotNames=[];var eSpotCreative=[];var eSpotRelPosition=[];var ga_eSpotIdsFinal=[];var ga_eSpotNamesFinal=[];var ga_eSpotCreativeFinal=[];var ga_eSpotRelPositionFinal=[];var exists=false;if(document.location.hostname=="recipes.sainsburys.co.uk"){if(document.getElementsByClassName("mission").length>0){var missionEl=document.getElementsByClassName("mission");for(var i=0;i<missionEl.length;i++){var id,path,creative,name;name="mission-promo";id=missionEl[i].style.backgroundImage.split('/').slice(-1)[0].substr(0,missionEl[i].style.backgroundImage.split('/').slice(-1)[0].lastIndexOf('.'));path=missionEl[i].style.backgroundImage.split('/').slice(3);creative='/'+path.join('/');creative=creative.substring(0,creative.indexOf('")'));ga_eSpotNamesFinal.push(name);ga_eSpotIdsFinal.push(id);ga_eSpotCreativeFinal.push(creative);ga_eSpotRelPositionFinal.push(i+1);}}
if(document.getElementsByClassName("mini-promo__item").length>0){var missionEl=document.getElementsByClassName("mini-promo__item");for(var i=0;i<missionEl.length;i++){var id,path,creative,name;name="mini-promo";var image=missionEl[i].getElementsByTagName("img");id=image[0].src.split('/').slice(-1)[0].substr(0,image[0].src.split('/').slice(-1)[0].lastIndexOf('.'));path=image[0].src.split('/').slice(3);creative='/'+path.join('/');ga_eSpotNamesFinal.push(name);ga_eSpotIdsFinal.push(id);ga_eSpotCreativeFinal.push(creative);ga_eSpotRelPositionFinal.push(i+1);}}
if(document.getElementsByClassName("rhs__promo").length>0){var missionEl=document.getElementsByClassName("rhs__promo");for(var i=0;i<missionEl.length;i++){var id,path,creative,name;name="rhs-promo";var image=missionEl[i].getElementsByTagName("img");id=image[0].src.split('/').slice(-1)[0].substr(0,image[0].src.split('/').slice(-1)[0].lastIndexOf('.'));path=image[0].src.split('/').slice(3);creative='/'+path.join('/');ga_eSpotNamesFinal.push(name);ga_eSpotIdsFinal.push(id);ga_eSpotCreativeFinal.push(creative);ga_eSpotRelPositionFinal.push(i+1);}}}
else if(document.getElementsByClassName("siteCatalystTag").length>0){x=document.getElementsByClassName("siteCatalystTag");var id;var divid;var eSpot_var;var prodEspot;for(var i=0;i<x.length;i++){id=x[i].innerHTML.toLowerCase();eSpots.push(id);var parentDiv=x[i].parentElement;if(eSpots[i]!=""){if(parentDiv.getElementsByClassName("productESpot").length>0){prodEspot=parentDiv.getElementsByClassName("productESpot");for(var j=0;j<prodEspot.length;j++){count=0;exists=false;var el=prodEspot[j].getElementsByTagName("img")[0];eSpot_var=el.src.split('/').slice(-1)[0].substr(0,el.src.split('/').slice(-1)[0].lastIndexOf('.'));for(var k=0;k<eSpotNames.length;k++){if(eSpotIds[k].split(">")[1]==eSpot_var){exists=true;}}
if(exists!=true){eSpotType.push(x[i].id);eSpotIds.push("productEspot>"+eSpot_var);if(typeof x[i].id!='undefined'){divId=x[i].id}
else{divId="noid"}
eSpotDivIds.push(divId);for(var n=0;n<eSpotNames.length;n++){if(eSpotNames[n]=="productESpot"){count=count+1;}}
pos=count+1;eSpotRelPosition.push(pos);substring=el.src.split('/').slice(3);creative='/'+substring.join('/');eSpotCreative.push(creative);eSpotNames.push("productESpot");exists=false;}}}
else if(parentDiv.className.indexOf("Page")==-1&&parentDiv.getElementsByTagName("img").length>0){prodEspot=parentDiv.getElementsByTagName("img");for(var l=0;l<prodEspot.length;l++){count=0;exists=false;if(prodEspot[l].className.indexOf("roundel")==-1&&(prodEspot[l].tagName=='A'||prodEspot[l].parentElement.tagName=='A')){var imgSrc=prodEspot[l].src.split('/').slice(-1)[0].substr(0,prodEspot[l].src.split('/').slice(-1)[0].lastIndexOf('.'));for(var k=0;k<eSpotNames.length;k++){if(eSpotIds[k].split(">")[1]==imgSrc){exists=true;}}
if(exists!=true){eSpotType.push(x[i].id);eSpotIds.push(eSpots[i]+">"+imgSrc);if(typeof x[i].id!='undefined'){divId=x[i].id}
else{divId="noid"}
eSpotDivIds.push(divId);for(var n=0;n<eSpotNames.length;n++){if(eSpotNames[n]==eSpots[i]){count=count+1;}}
pos=count+1;eSpotRelPosition.push(pos);substring=prodEspot[l].src.split('/').slice(3);creative='/'+substring.join('/');eSpotCreative.push(creative);eSpotNames.push(eSpots[i]);exists=false;}}}}}
}}
for(var q=0;q<eSpotIds.length;q++){try{var reg1=RegExp('^[0-9]+$');var reg2=RegExp('-[a-z0-9]{4}-');if(eSpotDivIds[q].indexOf("USA_CUST_NBR")==-1&&eSpotNames[q]!="upsell"&&reg1.test(eSpotNames[q])!=true&&reg2.test(eSpotNames[q])!=true&&eSpotNames[q]!="x-sell"&&eSpotNames[q].indexOf("<")!=0&&eSpotIds[q].indexOf("rating")==-1&&eSpotIds[q].indexOf("great_with")==-1&&eSpotIds[q].indexOf("do_you_need")==-1){ga_eSpotNamesFinal.push(eSpotNames[q]);ga_eSpotIdsFinal.push(eSpotIds[q]);ga_eSpotCreativeFinal.push(eSpotCreative[q]);ga_eSpotRelPositionFinal.push(eSpotRelPosition[q]);}}
catch(e){console.log(q,e)}}
b.ga_eSpotNamesFinal=ga_eSpotNamesFinal;b.ga_eSpotIdsFinal=ga_eSpotIdsFinal;b.ga_eSpotCreativeFinal=ga_eSpotCreativeFinal;b.ga_eSpotRelPositionFinal=ga_eSpotRelPositionFinal;}}catch(e){utag.DB(e)}},function(a,b){try{if(1){try{if(window.getFmToggleValue===undefined){window.getFmToggleValue=function(){var toggleValue="";try{if(tealium.jQuery("#fMaestroSuitabilityToggle").length==1){toggleValue=tealium.jQuery("#fMaestroSuitabilityToggle")[0].innerText;}}catch(err){console.warn("Tealium extension 195: Error.\n"+err);}
return toggleValue;}}}catch(err){console.warn("Tealium extension 195: Error.\n"+err);}
try{if(typeof(window.fMaestroSuitabilityToggleFlag2)=="undefined"&&(window.getFmToggleValue!==undefined)){tealium.jQuery("#fMaestroSuitabilityToggle").on("click",function(e){var ga_event_label=window.getFmToggleValue();if(ga_event_label.toLowerCase()=="on"){ga_event_label="Off";}else{ga_event_label="On";}
utag.link({"ga_event_category":"Food Maestro","ga_event_action":"Toggle","ga_event_label":ga_event_label,"fm_toggle_value":ga_event_label});});window.fMaestroSuitabilityToggleFlag2=true;}}catch(err){console.warn("Tealium extension 195: Error.\n"+err);}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){try{if(("last_button_pressed"in b)&&(b.last_button_pressed.toLowerCase()==="log in")){b.ga_events_array=[{eventCategory:"Successful Login",eventAction:"Successful Login"}];document.cookie="last_button_track=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";}}catch(err){console.log("\n\nTealium Extension 219. Error:\n"+err);}}}catch(e){utag.DB(e)}},function(a,b){try{if((typeof b['product_finding_method']!='undefined'&&typeof b['product_finding_method']!='undefined'&&b['product_finding_method']!='')){pfm=b.product_finding_method
var pfm_category;if(pfm.indexOf("favourites")==0){pfm_category="Favourites";}
else if(pfm.indexOf("search")==0){pfm_category="Search";}
else if(pfm.indexOf("forgottenFavourites")==0){pfm_category="Forgotten Favourites";}
else if(pfm.indexOf("shopping list Search")==0){pfm_category="Shopping List Search";}
else if(pfm.indexOf("trolley")==0){pfm_category="Trolley";}
else if(pfm.indexOf("Product Detail")==0){pfm_category="Product Detail";}
else if(pfm.indexOf("greatPrices")==0){pfm_category="Great Prices";}
else if(pfm.indexOf("peerius")==0){pfm_category="Peerius";}
else if(pfm.indexOf("hookLogic")==0){pfm_category="HookLogic";}
else if(pfm.indexOf("productUpsell")==0){pfm_category="Product Upsell";}
else if(pfm.indexOf("hierarchy")==0){pfm_category="Hierarchy";}
else if(pfm.indexOf("greatOffer")==0){pfm_category="Great Offers";}
else if(pfm.indexOf("productEspot")==0){pfm_category="Product Espot";}
else if(pfm.indexOf("SearchRedirect")==0){pfm_category="Search Redirect";}
else if(pfm.indexOf("replacement")==0){pfm_category="Replacement";}
else if(pfm.indexOf("importfav")==0){pfm_category="Import Favourites";}
else if(pfm.indexOf("discover")==0){pfm_category="Discover";}
else if(pfm.indexOf("crossSell")==0){pfm_category="Cross-Sell";}
else if(pfm.indexOf("upSell")==0){pfm_category="Upsell";}
else if(pfm.indexOf("nz")==0){pfm_category="Espot";}
else if(pfm.indexOf("mob_nz")==0){pfm_category="Espot";}
else if(pfm.indexOf("z:")==0){pfm_category="Espot";}
else if(pfm.indexOf("z_")==0){pfm_category="Espot";}
else if(pfm.indexOf("spotlight")==0){pfm_category="Search"}
else{pfm_category="(Other)";}
b.ga_pfm_category=pfm_category;}}catch(e){utag.DB(e)}},function(a,b){try{if(1){var profileInfo=digitalData.user.profile.profileInfo;if(profileInfo.isUkBilling&&(b.page_section==="checkout"||b.page_section==="my account")){b.is_uk_billing=profileInfo.isUkBilling;}}}catch(e){utag.DB(e)}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){u.o=window[window.GoogleAnalyticsObject];b.ga_events=b.ga_events||[];var c,d,e,f,g,h,tn,prop;if(u.data&&u.data.name){tn=u.data.name;}
u.data={"qsp_delim":"&","kvp_delim":"=","base_url":"","a":a,"cookieDomain":""||utag.loader.lh(),"name":tn||"","account":"UA-96326197-2","anonymizeIp":"false","allowLinker":"false","crossDomainTrack":"","enhancedLinkAttribution":"false","enhancedecommerce":"true","displayfeatures":"true","screenView":"false","optimizely":"false","init_before_extensions":"false","autofill_params":"true","autosend_events":"true"||"true","clear_global_vars":"false","enh_action":"","enh_event_cb":"","enh_checkout_step":"","enh_checkout_option":"","product_action_list":"","product_variant":[],"enh_impression_id":[],"enh_impression_name":[],"enh_impression_price":[],"enh_impression_category":[],"enh_impression_brand":[],"enh_impression_variant":[],"enh_impression_list":[],"enh_impression_position":[],"enh_promo_id":[],"enh_promo_name":[],"enh_promo_creative":[],"enh_promo_position":[],"id":"","product_id":[],"product_name":[],"product_brand":[],"product_category":[],"product_quantity":[],"product_unit_price":[],"product_discount":[],"product_position":[],"ga_events":[],"sessionControl":"","set":{}};if(u.data.init_before_extensions==="true"){u.createTracker();u.initTracker();}
for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};c=[];for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(e[f].indexOf("a.")===0){u.data["a"][e[f].substring(2)]=b[d];}else if(e[f].indexOf("set.")===0){u.data.set[e[f].substring(4)]=b[d];}else{u.data[e[f]]=b[d];}}}else{h=d.split(":");if(h.length===2&&b[h[0]]===h[1]){if(u.map[d]){u.data.enh_action=u.map[d];}}}}
u.data.account=u.data.tid||u.data.account;if(u.typeOf(u.data.ga_events)==="array"&&u.typeOf(b.ga_events)==="array"){if(u.data.ga_events.length===0&&b.ga_events.length>0){u.data.ga_events=b.ga_events;}else if(u.data.ga_events.length>0&&b.ga_events.length>0){u.data.ga_events=u.data.ga_events.concat(b.ga_events);}}
u.data.order_id=u.data.order_id||b._corder||"";u.data.order_total=u.data.order_total||b._ctotal||"";u.data.order_shipping=u.data.order_shipping||b._cship||"";u.data.order_tax=u.data.order_tax||b._ctax||"";u.data.order_store=u.data.order_store||b._cstore||"";u.data.order_currency=u.data.order_currency||b._ccurrency||"";u.data.order_coupon_code=u.data.order_coupon_code||b._cpromo||"";if(u.data.product_id.length===0&&b._cprod!==undefined){u.data.product_id=b._cprod.slice(0);}
if(u.data.product_name.length===0&&b._cprodname!==undefined){u.data.product_name=b._cprodname.slice(0);}
if(u.data.product_brand.length===0&&b._cbrand!==undefined){u.data.product_brand=b._cbrand.slice(0);}
if(u.data.product_category.length===0&&b._ccat!==undefined){u.data.product_category=b._ccat.slice(0);}
if(u.data.product_quantity.length===0&&b._cquan!==undefined){u.data.product_quantity=b._cquan.slice(0);}
if(u.data.product_unit_price.length===0&&b._cprice!==undefined){u.data.product_unit_price=b._cprice.slice(0);}
if(u.data.product_discount.length===0&&b._cpdisc!==undefined){u.data.product_discount=[];}
if(u.data.init_before_extensions!=="true"){u.createTracker();u.initTracker();}
if(u.data.enhancedecommerce==="true"&&!u.required["ec"]){u.required["ec"]=!0;u.all("require","ec");}
u.data.app_id=u.data.app_id||u.data.appId||b.app_id;u.data.app_name=u.data.app_name||u.data.appName||b.app_name;u.data.app_version=u.data.app_version||u.data.appVersion||b.app_version;u.data.app_rdns=u.data.app_rdns||u.data.appInstallerId||b.app_rdns;u.data.screen_title=u.data.screen_title||u.data.screenName||b.screen_title;if(u.data.app_id||u.data.app_name){g={};g.appName=u.data.app_name;g.appId=u.data.app_id||"";g.appVersion=u.data.app_version;g.appInstallerId=u.data.app_rdns;u.all("set",g);}
u.data.exception_reason=u.data.exception_reason||b.exception_reason;if(u.data.exception_reason){g={};g.exDescription=u.data.exception_reason;g.exFatal=true;u.all("send","exception",g);}
if(u.data.allowLinker==="true"||u.data.allowLinker===true){if(!u.required["linker"]){u.all("require","linker");u.required["linker"]=!0;}
if(u.data.crossDomainTrack){if(u.typeOf(u.data.crossDomainTrack)==="string"){u.data.crossDomainTrack=u.data.crossDomainTrack.replace(/\s/g,'').split(',');}
u.all("linker:autoLink",u.data.crossDomainTrack);}}
if(u.data.clear_global_vars==="true"){u.setGlobalProperties(u.data,true);for(prop in utag.loader.GV(u.data.set)){u.setGlobalProperties(u.data,true,prop);}}
u.setGlobalProperties(u.data,false);if(u.data.anonymizeIp==="true"||u.data.anonymizeIp===true){u.all("set",'anonymizeIp',true);}
if(u.data.uid){u.all("set","&uid",u.data.uid);}
if(u.data.page){u.all("set","page",u.data.page);}
if(u.data.title){u.all("set","title",u.data.title);}
if(u.data.location){u.all("set","location",u.data.location);}
if(u.data.campaignId){u.all("set","campaignId",u.data.campaignId);}
if(u.data.campaignName){u.all("set","campaignName",u.data.campaignName);}
if(u.data.campaignSource){u.all("set","campaignSource",u.data.campaignSource);}
if(u.data.campaignMedium){u.all("set","campaignMedium",u.data.campaignMedium);}
if(u.data.campaignContent){u.all("set","campaignContent",u.data.campaignContent);}
if(u.data.campaignKeyword){u.all("set","campaignKeyword",u.data.campaignKeyword);}
if(u.data.displayfeatures==="true"||u.data.displayfeatures===true){if(!u.required["displayfeatures"]){u.required["displayfeatures"]=!0;u.all("require","displayfeatures");}}else{u.all("set","displayFeaturesTask",null);}
if(u.data.dataSource){u.all("set","dataSource",u.data.dataSource);}
for(prop in utag.loader.GV(u.data.set)){u.all("set",prop,u.data.set[prop]);}
u.data.transaction_events={};u.data.pageview_events={};u.data.link_events={};u.data.enhecom_events={};for(d in utag.loader.GV(u.data)){if(d.indexOf("-")>-1&&(d.indexOf("metric")>-1||d.indexOf("dimension")>-1||d.indexOf("contentGroup")>-1)){if(d.indexOf("transaction-")===0){u.data.transaction_events[d]=u.data[d];}else if(d.indexOf("pageview-")===0){u.data.pageview_events[d]=u.data[d];}else if(d.indexOf("link-")===0){u.data.link_events[d]=u.data[d];}else if(u.data.enhancedecommerce==="true"&&d.indexOf("enh_")===0){u.data.enhecom_events[d]=u.data[d];}}else if(d.indexOf("metric")===0||d.indexOf("dimension")===0||d.indexOf("contentGroup")===0){u.all("set",d,u.data[d]);}}
if(u.data.enhancedLinkAttribution==="true"){if(!u.required["enhancedLinkAttribution"]){u.required["enhancedLinkAttribution"]=!0;u.all("require","linkid","linkid.js");}}
u.data.order_id=(u.data.order_id?u.data.order_id:u.data.id);if(u.data.enhancedecommerce==="true"){u.all("set",'&cu',(u.data.currency?u.data.currency:u.data.order_currency));if(u.data.order_id&&u.data.enh_action==="refund"){if(u.data.order_id instanceof Array&&u.data.order_id.length>0){u.data.order_id=u.data.order_id[0];}
for(f=0;f<u.data.product_id.length;f++){g={};g.id=u.data.product_id[f];g.quantity=(u.data.product_quantity[f]?u.data.product_quantity[f]:"1");g.price=(u.data.product_unit_price[f]?u.data.product_unit_price[f]:"1");u.setHitData(g,"enhecom_events","product_refund",f);u.all('ec:addProduct',g);}
g={};g.id=u.data.order_id;if(b.page_event=="cancellation"){g.revenue=u.data.revenue;}
u.setHitData(g,"enhecom_events","refund");u.all('ec:setAction','refund',g);}
else if(u.data.order_id&&typeof u.data.affiliation!="undefined"){if(u.data.affiliation.indexOf("chunk")==0){if(u.data.order_id instanceof Array&&u.data.order_id.length>0){u.data.order_id=u.data.order_id[0];}
if(u.data.affiliation!="chunk_n"){u.addproduct("product_purchase",u.data.product_id.length,false);}
else{u.data.order_total=0;u.data.order_shipping=0;u.data.order_tax=0;}
g={};g.id=u.data.order_id;g.affiliation=(u.data.affiliation?u.data.affiliation:u.data.order_store);g.revenue=(u.data.revenue?u.data.revenue:u.data.order_total);g.shipping=(u.data.shipping?u.data.shipping:u.data.order_shipping);g.tax=(u.data.tax?u.data.tax:u.data.order_tax);g.coupon=(u.data.coupon?u.data.coupon:u.data.order_coupon_code);u.setHitData(g,"enhecom_events","purchase");u.all('ec:setAction','purchase',g);}}
else if(u.data.enh_action==="product_click"&&u.data.a==="link"){u.addproduct("product_click",1,false);u.all('ec:setAction','click',{list:u.data.product_action_list});if(u.data.autosend_events==="true"){u.all('send','event','EEC','Product click',{'hitCallback':u.data.enh_event_cb});}
}
else if(u.data.enh_action==="detail"){u.addproduct("detail",1,false);g={};u.setHitData(g,"list",u.data.product_action_list);u.all("ec:setAction","detail");}
else if(u.data.enh_action==="add"){u.addproduct("product_add",u.data.product_id.length,false);u.all('ec:setAction','add',{list:u.data.product_action_list});if(u.data.a==="link"&&u.data.autosend_events==="true"){u.all('send','event','EEC','Add to cart',{'hitCallback':u.data.enh_event_cb});}
}
else if(u.data.enh_action==="remove"){u.addproduct("product_remove",u.data.product_id.length,false);u.all('ec:setAction','remove');if(u.data.a==="link"&&u.data.autosend_events==="true"){u.all('send','event','EEC','Remove from cart',{'hitCallback':u.data.enh_event_cb});}
}
else if(u.data.enh_action==="checkout"){u.addproduct("product_checkout",u.data.product_id.length,false);g={};g.step=u.data.enh_checkout_step||"1";g.option=u.data.enh_checkout_option;u.all('ec:setAction',u.data.enh_action,g);}
if(u.data.enh_action==="checkout_option"&&u.data.a==="link"){g={};g.step=u.data.enh_checkout_step||"1";g.option=u.data.enh_checkout_option;u.all('ec:setAction',u.data.enh_action,g);if(u.data.autosend_events==="true"){u.all('send','event','Checkout','Option',{'hitCallback':u.data.enh_event_cb});}
}
if(u.data.enh_impression_id&&b['link_name']!="Cart Add"&&utag.data.page_name!="groceries:checkout:order confirmation"&&utag.data.page_template!="productDetails"){u.addproduct("product_impression",u.data.enh_impression_id.length,true);}
if(u.data.enh_promo_id&&(u.data.enh_action=='promo_click'||u.data.a=='view')){u.addpromo(u.data.enh_action,u.data.a);}
g={};if(u.data.order_id){u.setHitData(g,"transaction_events");}
u.setHitData(g,"pageview_events");if(u.data.sessionControl==="start"||u.data.sessionControl==="end"){g.sessionControl=u.data.sessionControl;}
if(u.data.a==="view"){if(u.data.screenView==="true"||u.data.screenView===true){g.screenName=u.data.screen_title||"";u.all("send","screenview",g);}else{g.hitType="pageview";u.all("send",g);}}
}else if(u.data.a==="view"){g={};u.setHitData(g,"pageview_events");if(u.data.sessionControl==="start"||u.data.sessionControl==="end"){g.sessionControl=u.data.sessionControl;}
if(u.data.screenView==="true"||u.data.screenView===true){g.screenName=u.data.screen_title||"";u.all("send","screenview",g);}else{g.hitType="pageview";u.all("send",g);}
if(u.data.order_id&&!(u.data.order_id instanceof Array)){if(!u.required["ecommerce"]){u.required["ecommerce"]=!0;u.all("require","ecommerce","ecommerce.js");}
g={};u.setHitData(g,"transaction_events");g.id=u.data.order_id;g.affiliation=(u.data.affiliation?u.data.affiliation:u.data.order_store);g.revenue=(u.data.revenue?u.data.revenue:u.data.order_total);g.shipping=(u.data.shipping?u.data.shipping:u.data.order_shipping);g.tax=(u.data.tax?u.data.tax:u.data.order_tax);g.currency=(u.data.currency?u.data.currency:u.data.order_currency);u.all('ecommerce:addTransaction',g);for(f=0;f<u.data.product_id.length;f++){g={};g.id=u.data.order_id;g.sku=u.data.product_id[f];g.name=(u.data.product_name[f]?u.data.product_name[f]:u.data.product_id[f]);g.category=(u.data.product_category[f]?u.data.product_category[f]:"");g.price=(u.data.product_unit_price[f]?u.data.product_unit_price[f]:"1.00");g.quantity=(u.data.product_quantity[f]?u.data.product_quantity[f]:"1");u.setHitData(g,"transaction_events");u.all('ecommerce:addItem',g);}
u.all('ecommerce:send');}else if(u.data.order_id instanceof Array&&u.data.order_id.length>0){if(!u.required["ecommerce"]){u.required["ecommerce"]=!0;u.all("require","ecommerce","ecommerce.js");}
var lastindex=0;for(f=0;f<u.data.order_id.length;f++){if(f===u.data.order_id.length-1||(u.data.order_id[f]!==u.data.order_id[f+1])){g={};u.setHitData(g,"transaction_events");g.id=u.data.order_id[f];g.affiliation=(u.data.affiliation&&typeof u.data.affiliation[f]!=="undefined"?u.data.affiliation[f]:u.data.order_store);g.revenue=(u.data.revenue&&typeof u.data.revenue[f]!=="undefined"?u.data.revenue[f]:u.data.order_total);g.shipping=(u.data.shipping&&typeof u.data.shipping[f]!=="undefined"?u.data.shipping[f]:u.data.order_shipping);g.tax=(u.data.tax&&typeof u.data.tax[f]!=="undefined"?u.data.tax[f]:u.data.order_tax);g.currency=(u.data.currency?u.data.currency:u.data.order_currency);u.all('ecommerce:addTransaction',g);for(e=lastindex;e<f+1;e++){g={};g.id=u.data.order_id[f];g.sku=u.data.product_id[e];g.name=(u.data.product_name[e]?u.data.product_name[e]:u.data.product_id[e]);g.category=(u.data.product_category[e]?u.data.product_category[e]:"");g.price=(u.data.product_unit_price[e]?u.data.product_unit_price[e]:"1.00");g.quantity=(u.data.product_quantity[e]?u.data.product_quantity[e]:"1");u.setHitData(g,"transaction_events");u.all('ecommerce:addItem',g);}
lastindex=f+1;}}
u.all('ecommerce:send');}
}
if(u.data.eventCategory&&u.data.eventAction){g={};u.setHitData(g,"link_events");g.hitType="event";g.eventCategory=u.data.eventCategory;if(u.data.nonInteraction){g.nonInteraction=1;}
g.eventAction=u.data.eventAction;if(u.data.eventLabel){g.eventLabel=u.data.eventLabel;}
if(typeof u.data.eventValue!=="undefined"&&u.data.eventValue!==""){g.eventValue=u.data.eventValue;}
if(u.data.standard_event_cb){g.hitCallback=u.data.standard_event_cb;}
if(u.data.screenView==="true"||u.data.screenView===true){g.screenName=u.data.screen_title||"";}
if(u.data.sessionControl==="start"||u.data.sessionControl==="end"){g.sessionControl=u.data.sessionControl;}
u.all("send",g);u.data.eventCategory=u.data.eventAction=u.data.eventLabel=u.data.eventValue="";}
for(e=0;e<u.data.ga_events.length;e++){g={};u.setHitData(g,"link_events");g.hitType="event";g.eventCategory=u.data.ga_events[e].eventCategory;g.eventAction=u.data.ga_events[e].eventAction;g.eventLabel=u.data.ga_events[e].eventLabel;g.eventValue=u.data.ga_events[e].eventValue;if(u.data.ga_events[e].nonInteraction){g.nonInteraction=1;}
if(u.data.sessionControl==="start"||u.data.sessionControl==="end"){g.sessionControl=u.data.sessionControl;}
u.all("send",g);}
if(u.data.socialNetwork&&u.data.socialAction&&u.data.socialTarget){g={};g.hitType="social";g.socialNetwork=u.data.socialNetwork;g.socialAction=u.data.socialAction;g.socialTarget=u.data.socialTarget;u.all("send",g);u.data.socialNetwork=u.data.socialAction=u.data.socialTarget="";}
if(u.data.timingCategory&&u.data.timingVar&&u.data.timingValue){g={};g.hitType="timing";g.timingCategory=u.data.timingCategory;g.timingVar=u.data.timingVar;g.timingValue=u.data.timingValue;g.timingLabel=u.data.timingLabel||"";u.all("send",g);}
if(u.data["ga-disable"]){window["ga-disable-"+u.data["ga-disable"]]=true;}
(function(){var id="tealium-tag-7110";if(document.getElementById(id)){return;}
u.loader({"type":"script","src":"https://www.google-analytics.com/analytics.js","loc":"script","id":id});u.o.l=1*new Date();})();}};utag.o[loader].loader.LOAD(id);}('79','sainsburys.groceries'));}catch(error){utag.DB(error);}
